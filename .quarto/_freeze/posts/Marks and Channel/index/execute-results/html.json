{
  "hash": "d5f6de224b08c3e1432ab71df7b2ddd7",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Assignment 4\"\nsubtitle: \"Marks and Channel\"\nauthor: \"Morjina Solaiman\"\ndate: \"2025-02-20\"\ncategories: \"Assignment, Data Visualization\"\nformat: html\ncode-fold: true\ncode-tools: true\ndescription: \"HeatMap or HeatMess\"\n---\n\n\n\n### Good and Bad Plotting\n\nFor this assignment and for effectiveness and expressiveness part, I'm using my dataset that contains differentially expressed genes between ovaries and testis of a syngnathid fish. I have attached all the datasets used for this assignment in my marks and Channel folder.\n\nFirst load the packages and libraries.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load necessary Libraries\nlibrary(DESeq2)\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(tidyverse)\nlibrary(EnhancedVolcano)\nlibrary(gplots)\nlibrary(RColorBrewer)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Datasets ( Ovaries and Testis)\nres_SFO_vs_SNPT <- read.csv(\"res_SFO_vs_SNPT.csv\", header = TRUE, row.names = 1, sep = \",\")\n\nres_SFO_vs_SPT <-read.csv(\"res_SFO_vs_SPT.csv\", header = TRUE, row.names = 1, sep =\",\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#saveRDS(dds_ALL, file = \"dds_ALL.rds\")\ndds_ALL1 <- readRDS(\"dds_ALL.rds\")\n```\n:::\n\n\n\n## Expressiveness and Effectiveness\n\n### Figure1\n\nIn my first figure I use colour hues to express effectively the result. Below you can see 3 differnt colours represent clustering of 3 different samples. SFO = Syngnathus Female Ovaries SNPT = Syngnathus Non Pregnant Testis SPT = Syngnathus Pregnant Testis. This colours cleary expressing how different ovaries and Testis.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#rlog transform for application not for differential testing\nrld <- rlog(dds_ALL1)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#PCAplot, plotPCA which comes with DESeq2.\n# Run PCA and store the ggplot object\npca_plot <- plotPCA(rld, intgroup = \"All_condition\")\n\n# Customize colors using ggplot2\npca_plot + scale_color_manual(values = c(\"red2\",\"blue\", \n                                          \"magenta2\"))+\n  labs(title = \"PCA Plot of S_ovaries and S_Testis\", \n       x = \"PC1:84% Variance\", \n       y = \"PC2:4% Variance\", \n       color = \"Sample Groups\") +  # Add legend title\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n\n### Figure 2\n\nIn figure 2 we can see the violations of the principle of expressiveness and effectivemness. As, now we can't differentiate which one what and thus can't say if it's clustering or not. I used points as the marks which all identical and that's why meaningless.And the channel is colour which I used same blue colour for every sample making it hard to distinguish the cluster.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npca_plot + \n  scale_color_manual(values = c(\"blue\", \"blue\", \"blue\"))+\n  labs(title = \"PCA Plot\",\n       x = \"PC2: 99% Variance\",  # Incorrect variance\n       y = \"PC1: 1% Variance\",   # Swapped values to mislead\n       color = \"Totally Random Groups\") +  # Meaningless legend\n  theme(\n    panel.background = element_rect(fill = \"grey\"),  # Extreme background color\n    plot.title = element_text(size = 40, color = \"red\", face = \"bold\"),  # Overpowering title\n    axis.text = element_text(size = 10, color = \"white\"),\n    legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n\n## Discriminability\n\n### Figure 3\n\nFor the second part I tried to see the overall distribution of genes in ovaries and testis. I use bars as the marks and and length/height as channel\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nS_ovaries <- read.csv(\"final_count_ss_ovaries.csv\", header = TRUE, row.names = 1, sep = \",\")\nS_testes_oldref <- read.csv(\"final_count_ss_testes_oldrefgen.csv\", header = TRUE, row.names = 1, sep =\",\")\n\n#Histogram to check overall gene distribution\n#making a dataframe of sum of all row count\nS_tst_hist <- data.frame(rowSums(S_testes_oldref)) \nS_ov_hist <- data.frame(rowSums(S_ovaries))\n\n#changing the column names\nnames(S_tst_hist)[1] <- \"c1\"\nnames(S_ov_hist)[1] <- \"c3\"\n\nx_limits <- c(1, 1e07)  # Adjust based on your data range\ny_limits <- c(0, 1000)   # Adjust to match both plots\ny_breaks <- seq(0, 1000, by = 250)  # Ensure consistent y-axis breaks\nx_breaks <- c(10, 1000, 100000, 1e07)  # Adjust log-scale\n\n# Example for first dataset\nggplot(S_tst_hist, aes(x = c1)) + \n  geom_histogram(fill = \"blue4\", color = \"black\", bins = 100) +\n  scale_x_log10(limits = x_limits, breaks = x_breaks) + \n  scale_y_continuous(limits = y_limits, breaks = y_breaks) + \n  labs(title = \"Distribution of Overall Gene Counts Across S.scoveli Testis\", \n       x = \"Log(total counts)\", y = \"Frequency\") +\n  theme_gray()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n\n### Figure 4\n\nIn the figure 4 it violated the discriminability, Beacuse you can't properly measure the frequency of genes and overall distribution.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nS_ovaries <- read.csv(\"final_count_ss_ovaries.csv\", header = TRUE, row.names = 1, sep = \",\")\nS_testes_oldref <- read.csv(\"final_count_ss_testes_oldrefgen.csv\", header = TRUE, row.names = 1, sep =\",\")\n\n#Histogram to check overall gene distribution\n#making a dataframe of sum of all row count\nS_tst_hist <- data.frame(rowSums(S_testes_oldref)) \nS_ov_hist <- data.frame(rowSums(S_ovaries))\n\n#changing the column names\nnames(S_tst_hist)[1] <- \"c1\"\nnames(S_ov_hist)[1] <- \"c3\"\n\nx_limits <- c(1, 1e07)  # Adjust based on your data range\ny_limits <- c(0, 1000)   # Adjust to match both plots\ny_breaks <- seq(0, 1000, by = 250)  # Ensure consistent y-axis breaks\nx_breaks <- c(10, 1000, 100000, 1e07)  # Adjust log-scale\n\n# Example for first dataset\nggplot(S_tst_hist, aes(x = c1)) + \n  geom_histogram(fill= \"blue4\",color = \"black\",bins = 1000)+\n  scale_x_log10(limits = x_limits, breaks = x_breaks) + \n  scale_y_continuous(limits = y_limits, breaks = y_breaks) + \n  labs(title = \"Distribution of Overall Gene Counts Across S.scoveli Testis\", \n       x = \"Log(total counts)\", y = \"Frequency\") +\n  theme_gray()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n\n## Separability\n\n### Figure 5\n\nIn the separability part, I choose rectangular cells as marks and colour gradient as channels. In the figure is showing clearly some genes are really off in ovaries while those genes are on in testis making it clear that this dimporphic tissues have so many genes that expressed differntially.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntopVarGenes <- head( order( rowVars( assay(rld) ), decreasing=TRUE ), 35 )\nheatmap.2(assay(rld)[topVarGenes, ], \n          scale = \"row\", trace = \"none\", \n          dendrogram = \"column\", \n          col = colorRampPalette(rev(brewer.pal(9, \"RdBu\")))(255),\n          cexRow = 0.6,  # Adjust row label size\n          cexCol = 0.7,\n          main = \"S_Ov vs S_T\")  # Adjust column label size)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n\n### Figure 6/Heat Mess\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nheatmap.2(assay(rld)[topVarGenes, ], \n          scale = \"column\",  # Scale by column, which distorts comparisons\n          trace = \"both\",  # Add excessive trace lines\n          dendrogram = \"none\",  # Remove dendrograms to make the relationships unclear\n          col = colorRampPalette(rev(brewer.pal(9, \"RdGy\")))(255),  # Poor color choice with low contrast\n          cexRow = 2,  # Excessive row label size that clutters the plot\n          cexCol = 2,  # Excessive column label size that clutters the plot\n          main = \"S_Ov vs S_T (Bad Plot)\",  # A non-informative, cluttered title\n          density.info = \"none\",  # Remove density information for confusion\n          key.title = \"Expression Levels\",  # Confusing legend title\n          key.xlab = \"Expression\",  # Unclear labeling\n          key.ylab = \"Samples\")  # Unnecessary Y-axis label in the legend\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n\n## PopOut\n\n### Figure 7\n\nFor popout I used points as marks and colour as channel.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(DESeq2)\n\ndds_SFL_vs_SPL <- readRDS(\"dds_SFL_vs_SPL.rds\")\nres_SFL_vs_SPL <- results(dds_SFL_vs_SPL)\n\n#plotting\n#MA plot, x axis = mean expression & y axix = log2fold, c(-5,5) means log2fold value -5 to +5\n\nplotMA(res_SFL_vs_SPL, ylim = c(-5,5), main = \"Female vs Pregnant Male Liver\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n\n### Figure 8\n\nIn this figure I tried to violate the principles of Popout, making it hard to ditinguish what we are looking for. I tried to remove the blue popout colour but it's not working. However now I expand the y-axis too much which shrinks the genes in a way that we can't say which genes are differntially expressed and which are not. Figure 8 sucks because all marks are clumped together, and made the plot meaningless to explain.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Remove axis labels, use non-informative colors, set extreme point sizes, and distort y-axis\nplotMA(res_SFL_vs_SPL, \n       ylim = c(-5000000, 5000000),  # Overly exaggerated y-axis\n       main = \"\",\n       cex = 2)  # Extremely large points that overlap\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}