{
  "hash": "b7deab52e414f331c4baddfb0854e015",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Assignment 5\"\nsubtitle: \"NHL Draft Analysis\"\nauthor: \"Morjina Solaiman\"\ndate: \"2025-03-03\"\ncategories: [Assignment, Dataviz]\ncode-fold: true\ncode-tools: true\nformat: html\n---\n\n\n\n\n## NHL Draft Analysis\n### Load the dataset and libraries\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\nlibrary(tidyverse)\nlibrary(ggplot2)\nlibrary(readxl)\nNHLdraft <- read.csv(\"NHLdraft.csv\")\nNHLdraftstats <- read.csv(\"NHLdraftstats.csv\")\nNHLdictionary <- read_xlsx(\"NHLDictionary.xlsx\")\nknitr::kable(NHLdictionary)\n```\n\n::: {.cell-output-display}\n\n\n|Attribute   |Type         |Description                                                                                                           |\n|:-----------|:------------|:---------------------------------------------------------------------------------------------------------------------|\n|draftyear   |Ordinal      |Calendar year in which the player was drafted into the NHL.                                                           |\n|name        |Item         |Full name of the player.                                                                                              |\n|round       |Ordinal      |Round in which the player was drafted (1 to 7).                                                                       |\n|overall     |Ordinal      |Overall draft position of the player (1 to 224)                                                                       |\n|pickinRound |Ordinal      |Position in which the player was drafted in their round (1 to 32).                                                    |\n|height      |Quantitative |Player height in inches.                                                                                              |\n|weight      |Quantitative |Player weight in pounds.                                                                                              |\n|position    |Categorical  |Player position (Forward, Defense, Goaltender)                                                                        |\n|playerId    |Item         |Unique ID (key) assigned to each player.                                                                              |\n|postdraft   |Ordinal      |Number of seasons since being drafted (0 to 20).                                                                      |\n|NHLgames    |Quantitative |Number of games played in the NHL in that particular season (regular season is 82 games, playoffs are up to 28 more). |\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nView(NHLdraft)\nView(NHLdraftstats)\nView(NHLdictionary)\n```\n:::\n\n\n\n\nVisualization of games played by drafted player in 2022\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndraftNHL <- NHLdraftstats %>% \n  select(name, round, overall, draftyear, position) %>% \n  group_by(name, round, overall, draftyear, position)\n\ndraft2022 <- NHLdraft %>% \n  filter(draftyear == 2022 & postdraft == 0)\nggplot(draft2022, aes(x = round, y = NHLgames, color = overall))+\n  geom_point()+\n  geom_jitter(width = 0.2, alpha = 0.7, height = 0.5)+\n  labs(title = \"NHL draft Analysis of 2022\",\n       x = \"Hockey Games Round\",\n       y = \"NHLgames\")\n```\n\n::: {.cell-output-display}\n![](NHL_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n\nFigure1 : This figure shows the number of NHL games played by players drafted in June 2022, categorized by draft round. Each point represents a player, and jittering has been applied to reduce overplotting. The visualization highlights how most drafted players do not immediately play in the NHL\n\n## Expanded Scatterplot\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndraft2018 <- NHLdraftstats %>% \n  filter(draftyear == 2018 & postdraft < 6)\nggplot(draft2018, aes(x = round, y = NHLgames, color = postdraft))+\n  geom_point()\n```\n\n::: {.cell-output-display}\n![](NHL_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndrafttot2018 <- draft2018 %>% \n  group_by(playerId,round, overall, position, name) %>% \n  summarise(totgames = sum(NHLgames))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`summarise()` has grouped output by 'playerId', 'round', 'overall', 'position'.\nYou can override using the `.groups` argument.\n```\n\n\n:::\n\n```{.r .cell-code}\nggplot(drafttot2018, aes(x = round, y = totgames))+\n  geom_point()\n```\n\n::: {.cell-output-display}\n![](NHL_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n\n\n## Scatterplot with overall draft position\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(drafttot2018, aes(x = overall, y = totgames))+\n  geom_point()\n```\n\n::: {.cell-output-display}\n![](NHL_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n\n\n## Scatterplot summary\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(drafttot2018, aes(x = overall, y = totgames))+\n  geom_point()+\n  geom_smooth()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](NHL_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndrafttot <- NHLdraft %>% \n  filter(postdraft < 8) %>% \n  group_by(playerId, round, overall, position, name) %>% \n  summarise(totgames = sum(NHLgames))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`summarise()` has grouped output by 'playerId', 'round', 'overall', 'position'.\nYou can override using the `.groups` argument.\n```\n\n\n:::\n\n```{.r .cell-code}\nggplot(drafttot, aes(x = overall, y = totgames))+\n  geom_smooth(se = FALSE)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using method = 'gam' and formula = 'y ~ s(x, bs = \"cs\")'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](NHL_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n\n\n\nAverage number of games played as a function\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nNHLdraftstats <- read.csv(\"NHLdraftstats.csv\")\nEL <- NHLdraftstats %>% \n  filter(name == \"Elias Lindholm\")\n\nggplot(NHLdraftstats %>% \n         filter(position == \"Forward\"),\n       aes(x = postdraft, y = points))+\n  geom_smooth(aes(color = as.factor(round)))+\n  geom_point(data = EL, aes(x = postdraft, y = points), color = \"red\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using method = 'gam' and formula = 'y ~ s(x, bs = \"cs\")'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](NHL_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nEL <-  NHLdraftstats %>%\n  filter(name == \"Elias Lindholm\")\npick_31_range <-  NHLdraftstats %>% \n  filter()\n```\n:::\n\n\n\n## Barplot\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndrafttot2018 %>% filter(totgames > 15 & position == \"Forward\") %>%  ggplot(aes( y = reorder(name, totgames), x = totgames))+\n  geom_col(color = \"white\", fill = \"blue4\")+\n  labs(title = \"Total games played by individual player in 2018\",\n       y = \"Player Names\", x = \"Total Games\")+\n  theme(axis.text.x = element_text(angle = 90),\n        legend.title = element_blank())\n```\n\n::: {.cell-output-display}\n![](NHL_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n\n\n## Stacked Bar Chart\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(draft2018, aes(x = postdraft, y = NHLgames, fill = as.factor(-round)))+\n  geom_col(position = \"stack\")\n```\n\n::: {.cell-output-display}\n![](NHL_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nNHLdraft1 <- NHLdraft %>% \n  mutate(descround = desc(as.factor(round)))\n\nrounds <- c(\"darkred\", \"blue\", \"red\", \"darkblue\", \"pink\", \"violet\", \"lightblue\")\n\nggplot(NHLdraft, aes(x = postdraft, y = NHLgames, fill = as.factor(-round)))+\n  geom_col(position = \"stack\")+\n  labs(title = \"Pattern of play after drafting\",\n       x = \"PostDraft\",\n       y = \"Number of NHLgames\")+\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](NHL_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "NHL_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}